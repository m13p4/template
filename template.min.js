/**
 * Template - a simple js templating handler 
 * 
 * @version 1.0
 * @author m13p4
 * @copyright Meliantchenkov Pavel
 * @license https://github.com/m13p4/template/blob/master/LICENSE
 */
var Template=function(){function h(c,f,b){b=b||0;f=f instanceof Array?f:[f];for(var e,a=!1,d=0;d<f.length;d++)e=c.indexOf(f[d],b),a=-1<e&&(e<a||!1===a)?e:a;return!1===a?-1:a}function q(l,f){for(var b=f?"":"var PRINT='';",e,a,d,g,n=0,k=0,t=new RegExp(c.r,"g");(e=t.exec(l))&&1E4>k;)a=l.substring(n,e.index),n=e.index+e[0].length,b+="PRINT +="+JSON.stringify(a)+";",d="",a=e[1],g=h(a,":"),-1<g&&(d=p(a.substring(0,g)),a=p(a.substring(g+1))),-1<h(x,a)&&(d=a,a=""),d=d.toLowerCase(),"</"==e[0].substr(0,2)?
b+="}":""==d?b+="PRINT+="+a+";"+c.c:-1<h(m.js,d)?b+=a+c.c:-1<h(m["if"],d)?b+="if("+a+c.c+"){":-1<h(m["else"],d)?b+="}else{":-1<h(m.elseif,d)?b+="}else if("+a+c.c+"){":-1<h(m["for"],d)?(g={i:h(a,"=>")},0>g.i?b+="for("+a+c.c+"){":(g.o=a.substring(0,g.i),g.k=a.substring(g.i+2).split(","),b+="for(var _$i in "+p(g.o)+c.c+"){",b=1==g.k.length?b+("var "+p(g.k[0])+c.c+"="+p(g.o)+c.c+"[_$i];"):b+("var "+p(g.k[1])+c.c+"="+p(g.o)+c.c+"[_$i], "+p(g.k[0])+c.c+"=_$i;"))):-1<h(m["while"],d)?b+="while("+a+c.c+"){":
-1<h(m.imp,d)&&(b+=r[a]?q(r[a].t,!0):""),k++;return b+="PRINT+="+JSON.stringify(l.substring(n))+";"+(f?"":" return PRINT;")}var k={},c={p:"<{",s:"}>",cp:"</{",cs:"}/>",r:/<\/?\s*\{([\s\S]*?)\}\s*\/?>/.source,c:"//*/\n"},m={tmpl:["tmpl","template"],"if":["if"],"else":["else"],elseif:["elseif","else if"],"for":["for"],"while":["while"],imp:"imp import inc include req require".split(" "),js:["js","code"]},x=function(){var c=[],f;for(f in m)c=c.concat(m[f]);return c}(),r={},p=new Function("s","return "+
(String.prototype.trim?"s.trim()":"s.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,'')")+";");k.addTemplate=function(c,f){r[c]={t:f};return k};k.readTemplate=function(l){for(var f=[],b=[],e=m.tmpl,a,d=0;d<e.length;d++)f.push(c.p+e[d]),b.push(c.cp+e[d]);a=0;for(var g,n,q,t,u,v,w=0;-1<(g=h(l,f,a))&&1E3>w;){a=!1;for(d=0;d<f.length;d++)if(l.substr(g,f[d].length)===f[d]){a=e[d];break}a&&(n=h(l,c.s,g))&&-1<n&&(u=h(l,b,n))&&-1<u&&(q=l.substring(g+c.p.length,n))&&(v=l.substring(n+c.s.length,u))&&(t=
p(q.substr(a.length+1))||"");v&&(r[t]={t:v});a=u+c.cp.length+a.length+c.s.length;w++}return k};k.parse=function(c,f){var b=c;var e=f;"object"==typeof b&&(e=b,b="");e=e||{};b=r[b||""];if(b){b.f||(b.f=q(b.t));var a=[null].concat(Object.keys(e));a.push(b.f);e=(new (Function.prototype.bind.apply(Function,a))).apply(null,Object.values(e))}else e="";return e};k.render=k.parse;return k}();
