/**
 * Template - a simple js templating handler 
 * 
 * @version 1.0
 * @author m13p4
 * @copyright Meliantchenkov Pavel
 * @license https://github.com/m13p4/template/blob/master/LICENSE
 */
var Template=function(){function h(c,e,b){b=b||0;e=e instanceof Array?e:[e];for(var d,a=-1,g=0;g<e.length;g++)d=c.indexOf(e[g],b),a=-1<d&&(d<a||-1==a)?d:a;return a}function r(l,e){for(var b=e?"":"var PRINT='';",d,a,g,f,p=0,k=0,u=new RegExp(c.r,"g");(d=u.exec(l))&&1E4>k;)a=l.substring(p,d.index),p=d.index+d[0].length,b+="PRINT +="+JSON.stringify(a)+";",g="",a=d[1],f=h(a,":"),-1<f&&(g=q(a.substring(0,f)),a=q(a.substring(f+1))),-1<h(x,a)&&(g=a,a=""),g=g.toLowerCase(),"</"==d[0].substr(0,2)?b+="}":""==
g?b+="PRINT+="+a+";"+c.c:-1<h(m.js,g)?b+=a+c.c:-1<h(m["if"],g)?b+="if("+a+c.c+"){":-1<h(m["else"],g)?b+="}else{":-1<h(m.elseif,g)?b+="}else if("+a+c.c+"){":-1<h(m["for"],g)?(f={i:h(a,"=>")},0>f.i?b+="for("+a+c.c+"){":(f.o=a.substring(0,f.i),f.k=a.substring(f.i+2).split(","),b+="for(var _$i in "+q(f.o)+c.c+"){",b=1==f.k.length?b+("var "+q(f.k[0])+c.c+"="+q(f.o)+c.c+"[_$i];"):b+("var "+q(f.k[1])+c.c+"="+q(f.o)+c.c+"[_$i], "+q(f.k[0])+c.c+"=_$i;"))):-1<h(m["while"],g)?b+="while("+a+c.c+"){":-1<h(m.imp,
g)&&(b+=t[a]?r(t[a].t,!0):""),k++;return b+="PRINT+="+JSON.stringify(l.substring(p))+";"+(e?"":" return PRINT;")}var k={},c={p:"<{",s:"}>",cp:"</{",cs:"}/>",r:/<\/?\s*\{([\s\S]*?)\}\s*\/?>/.source,c:"//*/\n"},m={tmpl:["tmpl","template"],"if":["if"],"else":["else"],elseif:["elseif","else if"],"for":["for"],"while":["while"],imp:"imp import inc include req require".split(" "),js:["js","code"]},x=function(){var c=[],e;for(e in m)c=c.concat(m[e]);return c}(),t={},q=new Function("s","return "+(String.prototype.trim?
"s.trim()":"s.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,'')")+";");k.addTemplate=function(c,e){t[c]={t:e};return k};k.readTemplate=function(l){for(var e=[],b=[],d=m.tmpl,a=0,g=0,f,p,r,u,v,w,n=0;n<d.length;n++)e.push(c.p+d[n]),b.push(c.cp+d[n]);for(;-1<(f=h(l,e,a))&&1E3>g;){a=!1;for(n=0;n<e.length;n++)if(l.substr(f,e[n].length)===e[n]){a=d[n];break}a&&(p=h(l,c.s,f))&&-1<p&&(v=h(l,b,p))&&-1<v&&(r=l.substring(f+c.p.length,p))&&(w=l.substring(p+c.s.length,v))&&(u=q(r.substr(a.length+1))||"");
w&&(t[u]={t:w});a=v+c.cp.length+a.length+c.s.length;g++}return k};k.parse=function(c,e){var b=c;var d=e;"object"==typeof b&&(d=b,b="");d=d||{};b=t[b||""];if(b){b.f||(b.f=r(b.t));var a=[null].concat(Object.keys(d));a.push(b.f);d=(new (Function.prototype.bind.apply(Function,a))).apply(null,Object.values(d))}else d="";return d};k.render=k.parse;return k}();
