/**
 * Template - a simple js templating handler 
 * 
 * @version 1.0
 * @author m13p4
 * @copyright Meliantchenkov Pavel
 * @license https://github.com/m13p4/template/blob/master/LICENSE
 */
var Template=function(){function p(c,g){for(var a=g?"":"var PRINT='';",f,b,d,e,k=0,q=0,r=new RegExp(m.r,"g");(f=r.exec(c))&&1E4>q;)b=c.substring(k,f.index),k=f.index+f[0].length,a+="PRINT +="+JSON.stringify(b)+";",d="",b=f[1],e=b.indexOf(":"),-1<e&&(d=l(b.substring(0,e)),b=l(b.substring(e+1))),-1<t.indexOf(b)&&(d=b,b=""),"</"==f[0].substr(0,2)&&(d="/"+d),d=d.toLowerCase(),""==d?a+="PRINT+="+b+";\n//*/\n":-1<h.js.indexOf(d)?a+=b+"\n//*/\n":-1<h["if"].indexOf(d)?a+="if("+b+"\n//*/\n){":-1<h["else"].indexOf(d)?
a+="}else{":-1<h.elseif.indexOf(d)?a+="}else if("+b+"\n//*/\n){":-1<h["for"].indexOf(d)?(e={i:b.indexOf("=>")},0>e.i?a+="for("+b+"\n//*/\n){":(e.o=b.substring(0,e.i),e.k=b.substring(e.i+2).split(","),a+="for(var _$i in "+l(e.o)+"\n//*/\n){",a=1==e.k.length?a+("var "+l(e.k[0])+"\n//*/\n="+l(e.o)+"\n//*/\n[_$i];"):a+("var "+l(e.k[1])+"\n//*/\n="+l(e.o)+"\n//*/\n[_$i], "+l(e.k[0])+"\n//*/\n=_$i;"))):-1<h["while"].indexOf(d)?a+="while("+b+"\n//*/\n){":-1<h.imp.indexOf(d)?a+=n[b]?p(n[b].t,!0):"":"/"==
d.charAt(0)&&(a+="}"),q++;return a+="PRINT+="+JSON.stringify(c.substring(k))+";"+(g?"":" return PRINT;")}var k={},m={p:"<{",s:"}>",cp:"</{",cs:"}/>",r:/<\/?\s*\{([\s\S]*?)\}\s*\/?>/.source},h={tmpl:["tmpl","template"],"if":["if"],"else":["else"],elseif:["elseif","else if"],"for":["for"],"while":["while"],imp:"imp import inc include req require".split(" "),js:["js","code"]},t=function(){var c=[],g;for(g in h)c=c.concat(h[g]);return c}(),n={},l=String.prototype.trim?function(c){return c.trim()}:function(c){return c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
"")};k.addTemplate=function(c,g){n[c]={t:g};return k};k.readTemplate=function(c){for(var g=0,a,f,b,d,e,h=0;-1<(g=c.indexOf(m.p+"tmpl",g))&&1E3>h;)(a=c.indexOf(m.s,g))&&-1<a&&(d=c.indexOf(m.cp+"tmpl",a))&&-1<d&&(f=c.substring(g+m.p.length,a))&&(e=c.substring(a+m.s.length,d))&&(b=l(f.substr(5))||""),e&&(n[b]={t:e}),g=d+m.cp.length+4+m.s.length,h++;return k};k.parse=function(c,g){var a=c;var f=g;"object"==typeof a&&(f=a,a="");f=f||{};a=n[a||""];if(a){a.f||(a.f=p(a.t));var b=[null].concat(Object.keys(f));
b.push(a.f);f=(new (Function.prototype.bind.apply(Function,b))).apply(null,Object.values(f))}else f="";return f};k.render=k.parse;return k}();
